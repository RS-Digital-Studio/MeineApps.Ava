<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:BomberBlast.ViewModels"
             xmlns:mi="using:Material.Icons.Avalonia"
             xmlns:controls="using:BomberBlast.Controls"
             x:Class="BomberBlast.Views.DailyChallengeView"
             x:DataType="vm:DailyChallengeViewModel">

  <Panel AutomationProperties.AutomationId="DailyChallenge_Root">
    <controls:MenuBackgroundCanvas />

    <Grid RowDefinitions="Auto,*,Auto" Margin="24,16,24,80">

      <!-- Header: Titel + Zurück-Button -->
      <Grid Grid.Row="0" ColumnDefinitions="Auto,*" Margin="0,0,0,16">
        <Button Grid.Column="0" Classes="Secondary GameButton"
                Command="{Binding BackCommand}"
                Width="48" Height="48"
                Padding="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                AutomationProperties.AutomationId="DailyChallenge_BtnBack">
          <mi:MaterialIcon Kind="ArrowLeft" Width="24" Height="24"
                           Foreground="{DynamicResource TextPrimaryBrush}" />
        </Button>

        <TextBlock Grid.Column="1"
                   Text="{Binding DailyChallengeTitle}"
                   FontSize="28" FontWeight="Bold"
                   Foreground="{DynamicResource AccentBrush}"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   AutomationProperties.AutomationId="DailyChallenge_TxtTitle" />
      </Grid>

      <!-- Mitte: Stats in 2-Spalten-Layout -->
      <Grid Grid.Row="1"
            ColumnDefinitions="*,*"
            VerticalAlignment="Center"
            Margin="0,0,0,0">

        <!-- Linke Spalte: Haupt-Score + Streak-Info -->
        <StackPanel Grid.Column="0"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    Spacing="16">

          <!-- Best Score (groß, prominent) - Gold-Gradient als Hero-Element -->
          <Border CornerRadius="16" Padding="20,16"
                  BoxShadow="0 2 8 0 #25000000"
                  HorizontalAlignment="Stretch"
                  MinWidth="200"
                  AutomationProperties.AutomationId="DailyChallenge_BestScoreCard">
            <Border.Background>
              <LinearGradientBrush StartPoint="0%,0%" EndPoint="0%,100%">
                <GradientStop Color="#35332200" Offset="0" />
                <GradientStop Color="{DynamicResource SurfaceColor}" Offset="1" />
              </LinearGradientBrush>
            </Border.Background>
            <StackPanel Spacing="4" HorizontalAlignment="Center">
              <TextBlock Text="{Binding BestScoreLabel}"
                         FontSize="13"
                         Foreground="{DynamicResource TextMutedBrush}"
                         HorizontalAlignment="Center"
                         AutomationProperties.AutomationId="DailyChallenge_TxtBestScoreLabel" />
              <TextBlock Text="{Binding TodayBestScoreText}"
                         FontSize="36" FontWeight="Bold"
                         Foreground="#FFD700"
                         HorizontalAlignment="Center"
                         AutomationProperties.AutomationId="DailyChallenge_TxtBestScore" />
            </StackPanel>
          </Border>

          <!-- Streak-Bonus -->
          <Border Background="{DynamicResource SurfaceBrush}"
                  CornerRadius="12" Padding="16,10"
                  BoxShadow="0 2 8 0 #25000000"
                  HorizontalAlignment="Stretch"
                  MinWidth="200"
                  AutomationProperties.AutomationId="DailyChallenge_StreakBonusCard">
            <StackPanel Spacing="4" HorizontalAlignment="Center">
              <TextBlock Text="{Binding StreakBonusLabel}"
                         FontSize="13"
                         Foreground="{DynamicResource TextMutedBrush}"
                         HorizontalAlignment="Center" />
              <TextBlock Text="{Binding StreakBonusText}"
                         FontSize="20" FontWeight="SemiBold"
                         Foreground="{DynamicResource SuccessBrush}"
                         HorizontalAlignment="Center"
                         AutomationProperties.AutomationId="DailyChallenge_TxtStreakBonus" />
            </StackPanel>
          </Border>

          <!-- Heute bereits gespielt Hinweis -->
          <Border Background="#60FF6B00"
                  CornerRadius="8" Padding="12,8"
                  IsVisible="{Binding IsCompletedToday}"
                  HorizontalAlignment="Center"
                  AutomationProperties.AutomationId="DailyChallenge_CompletedBadge">
            <StackPanel Orientation="Horizontal" Spacing="8">
              <mi:MaterialIcon Kind="CheckCircle" Width="18" Height="18"
                               Foreground="#FF6B00" />
              <TextBlock Text="{Binding CompletedTodayText}"
                         FontSize="14" FontWeight="SemiBold"
                         Foreground="#FF6B00"
                         VerticalAlignment="Center"
                         AutomationProperties.AutomationId="DailyChallenge_TxtCompleted" />
            </StackPanel>
          </Border>
        </StackPanel>

        <!-- Rechte Spalte: Stats-Karten -->
        <Grid Grid.Column="1"
              RowDefinitions="Auto,Auto,Auto"
              VerticalAlignment="Center"
              HorizontalAlignment="Center"
              Margin="16,0,0,0">

          <!-- Streak - Farbiger Akzent-Rand links (orange, passend zum Fire-Icon) -->
          <Border Grid.Row="0" Background="{DynamicResource SurfaceBrush}"
                  CornerRadius="12" Padding="16,12"
                  Margin="0,0,0,8" MinWidth="180"
                  BoxShadow="0 2 8 0 #25000000"
                  BorderBrush="#FF6B00" BorderThickness="3,0,0,0"
                  AutomationProperties.AutomationId="DailyChallenge_StreakCard">
            <Grid ColumnDefinitions="Auto,*">
              <mi:MaterialIcon Grid.Column="0" Kind="Fire" Width="28" Height="28"
                               Foreground="#FF6B00" Margin="0,0,12,0" />
              <StackPanel Grid.Column="1">
                <TextBlock Text="{Binding StreakLabel}"
                           FontSize="12"
                           Foreground="{DynamicResource TextMutedBrush}" />
                <TextBlock Text="{Binding CurrentStreakText}"
                           FontSize="24" FontWeight="Bold"
                           Foreground="{DynamicResource TextPrimaryBrush}"
                           AutomationProperties.AutomationId="DailyChallenge_TxtStreak" />
              </StackPanel>
            </Grid>
          </Border>

          <!-- Längste Streak - Farbiger Akzent-Rand links (gold, passend zum Trophy-Icon) -->
          <Border Grid.Row="1" Background="{DynamicResource SurfaceBrush}"
                  CornerRadius="12" Padding="16,12"
                  Margin="0,0,0,8" MinWidth="180"
                  BoxShadow="0 2 8 0 #25000000"
                  BorderBrush="#FFD700" BorderThickness="3,0,0,0"
                  AutomationProperties.AutomationId="DailyChallenge_LongestStreakCard">
            <Grid ColumnDefinitions="Auto,*">
              <mi:MaterialIcon Grid.Column="0" Kind="Trophy" Width="28" Height="28"
                               Foreground="#FFD700" Margin="0,0,12,0" />
              <StackPanel Grid.Column="1">
                <TextBlock Text="{Binding LongestStreakLabel}"
                           FontSize="12"
                           Foreground="{DynamicResource TextMutedBrush}" />
                <TextBlock Text="{Binding LongestStreakText}"
                           FontSize="24" FontWeight="Bold"
                           Foreground="{DynamicResource TextPrimaryBrush}"
                           AutomationProperties.AutomationId="DailyChallenge_TxtLongestStreak" />
              </StackPanel>
            </Grid>
          </Border>

          <!-- Gesamt abgeschlossen - Farbiger Akzent-Rand links (Secondary, passend zum Calendar-Icon) -->
          <Border Grid.Row="2" Background="{DynamicResource SurfaceBrush}"
                  CornerRadius="12" Padding="16,12"
                  MinWidth="180"
                  BoxShadow="0 2 8 0 #25000000"
                  BorderBrush="{DynamicResource SecondaryBrush}" BorderThickness="3,0,0,0"
                  AutomationProperties.AutomationId="DailyChallenge_TotalCard">
            <Grid ColumnDefinitions="Auto,*">
              <mi:MaterialIcon Grid.Column="0" Kind="CalendarCheck" Width="28" Height="28"
                               Foreground="{DynamicResource SecondaryBrush}" Margin="0,0,12,0" />
              <StackPanel Grid.Column="1">
                <TextBlock Text="{Binding CompletedLabel}"
                           FontSize="12"
                           Foreground="{DynamicResource TextMutedBrush}" />
                <TextBlock Text="{Binding TotalCompletedText}"
                           FontSize="24" FontWeight="Bold"
                           Foreground="{DynamicResource TextPrimaryBrush}"
                           AutomationProperties.AutomationId="DailyChallenge_TxtTotal" />
              </StackPanel>
            </Grid>
          </Border>
        </Grid>
      </Grid>

      <!-- Unten: Play-Button - Torn Metal mit warmem Orange -->
      <Panel Grid.Row="2" MinHeight="60" MinWidth="280"
             HorizontalAlignment="Center"
             Margin="0,16,0,0">
        <controls:GameButtonCanvas ButtonColor="#FF6B00" DamageLevel="0.5" ButtonSeed="90" />
        <Button Classes="Primary GameButton"
                Command="{Binding PlayChallengeCommand}"
                Background="Transparent"
                Foreground="White"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                VerticalContentAlignment="Center"
                Height="60"
                AutomationProperties.AutomationId="DailyChallenge_BtnPlay">
          <StackPanel Orientation="Horizontal" Spacing="10">
            <mi:MaterialIcon Kind="Sword" Width="24" Height="24"
                             Foreground="White" />
            <TextBlock Text="{Binding PlayButtonText}"
                       FontSize="18" FontWeight="Bold"
                       Foreground="White"
                       VerticalAlignment="Center" />
          </StackPanel>
        </Button>
      </Panel>

    </Grid>
  </Panel>

</UserControl>
