<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:BomberBlast.ViewModels"
             xmlns:mi="using:Material.Icons.Avalonia"
             xmlns:loc="using:MeineApps.Core.Ava.Localization"
             xmlns:skia="using:Avalonia.Labs.Controls"
             xmlns:controls="using:BomberBlast.Controls"
             x:Class="BomberBlast.Views.LuckySpinView"
             x:DataType="vm:LuckySpinViewModel">

  <Panel AutomationProperties.AutomationId="LuckySpin_Root">
    <controls:MenuBackgroundCanvas BackgroundTheme="LuckySpin" />

    <Grid ColumnDefinitions="*,Auto" Margin="24,16,24,80">

      <!-- Links: GlÃ¼cksrad (SKCanvasView) -->
      <Panel Grid.Column="0" Margin="0,0,16,0">
        <skia:SKCanvasView x:Name="WheelCanvas"
                           AutomationProperties.AutomationId="LuckySpin_WheelCanvas" />
      </Panel>

      <!-- Rechts: Buttons + Info -->
      <StackPanel Grid.Column="1"
                  VerticalAlignment="Center"
                  HorizontalAlignment="Center"
                  Width="200"
                  Spacing="12">

        <!-- Titel -->
        <StackPanel Orientation="Horizontal" Spacing="8"
                    HorizontalAlignment="Center">
          <mi:MaterialIcon Kind="ChartDonut" Width="28" Height="28"
                           Foreground="{DynamicResource GoldAccentBrush}" />
          <TextBlock Text="{loc:Translate LuckySpinTitle}"
                     FontSize="24" FontWeight="Bold"
                     Foreground="{DynamicResource GoldAccentBrush}"
                     AutomationProperties.AutomationId="LuckySpin_Title" />
        </StackPanel>

        <!-- Coin-Badge -->
        <Border Background="{DynamicResource SurfaceBrush}"
                CornerRadius="12" Padding="12,8"
                HorizontalAlignment="Center"
                BoxShadow="0 2 8 0 #25000000"
                BorderBrush="#40FFD700" BorderThickness="1"
                AutomationProperties.AutomationId="LuckySpin_CoinBadge">
          <StackPanel Orientation="Horizontal" Spacing="8">
            <mi:MaterialIcon Kind="CircleMultiple" Width="20" Height="20"
                             Foreground="{DynamicResource GoldAccentBrush}" />
            <TextBlock Text="{Binding CoinsText}"
                       FontSize="17" FontWeight="Bold"
                       Foreground="{DynamicResource GoldAccentBrush}"
                       VerticalAlignment="Center" />
          </StackPanel>
        </Border>

        <!-- Ergebnis-Anzeige -->
        <Border IsVisible="{Binding ShowResult}"
                CornerRadius="12" Padding="14,12"
                HorizontalAlignment="Stretch"
                BoxShadow="0 2 8 0 #25000000"
                BorderBrush="#40FFD700" BorderThickness="1"
                AutomationProperties.AutomationId="LuckySpin_Result">
          <Border.Background>
            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
              <GradientStop Color="#30FFD700" Offset="0" />
              <GradientStop Color="{DynamicResource SurfaceColor}" Offset="1" />
            </LinearGradientBrush>
          </Border.Background>
          <StackPanel Spacing="6" HorizontalAlignment="Center">
            <mi:MaterialIcon Kind="Star" Width="32" Height="32"
                             Foreground="{DynamicResource GoldAccentBrush}"
                             HorizontalAlignment="Center" />
            <TextBlock Text="{Binding ResultText}"
                       FontSize="20" FontWeight="Bold"
                       Foreground="{DynamicResource GoldAccentBrush}"
                       HorizontalAlignment="Center"
                       TextAlignment="Center" />
          </StackPanel>
        </Border>

        <!-- Spin / Collect Button -->
        <Panel MinHeight="56" IsVisible="{Binding !ShowResult}">
          <controls:GameButtonCanvas ButtonColor="#FFD700" DamageLevel="0.6" ButtonSeed="80" />
          <Button Classes="Primary GameButton"
                  Command="{Binding SpinWheelCommand}"
                  IsEnabled="{Binding CanSpin}"
                  Background="Transparent"
                  Foreground="White"
                  HorizontalAlignment="Stretch"
                  HorizontalContentAlignment="Center"
                  VerticalContentAlignment="Center"
                  Height="56"
                  AutomationProperties.AutomationId="LuckySpin_BtnSpin">
            <StackPanel Orientation="Horizontal" Spacing="8">
              <mi:MaterialIcon Kind="Play" Width="22" Height="22"
                               Foreground="#1A1A2A"
                               IsVisible="{Binding IsFreeSpinAvailable}" />
              <mi:MaterialIcon Kind="Video" Width="22" Height="22"
                               Foreground="#1A1A2A"
                               IsVisible="{Binding !IsFreeSpinAvailable}" />
              <TextBlock Text="{Binding SpinButtonText}"
                         FontSize="17" FontWeight="Bold"
                         Foreground="#1A1A2A" />
            </StackPanel>
          </Button>
        </Panel>

        <!-- Collect Button (nach Spin) -->
        <Panel MinHeight="56" IsVisible="{Binding ShowResult}">
          <controls:GameButtonCanvas ButtonColor="#22C55E" DamageLevel="0.3" ButtonSeed="81" />
          <Button Classes="Primary GameButton"
                  Command="{Binding CollectRewardCommand}"
                  Background="Transparent"
                  Foreground="White"
                  HorizontalAlignment="Stretch"
                  HorizontalContentAlignment="Center"
                  VerticalContentAlignment="Center"
                  Height="56"
                  AutomationProperties.AutomationId="LuckySpin_BtnCollect">
            <StackPanel Orientation="Horizontal" Spacing="8">
              <mi:MaterialIcon Kind="CheckCircle" Width="22" Height="22"
                               Foreground="White" />
              <TextBlock Text="{Binding SpinButtonText}"
                         FontSize="17" FontWeight="Bold"
                         Foreground="White" />
            </StackPanel>
          </Button>
        </Panel>

        <!-- Total Spins -->
        <TextBlock Text="{Binding TotalSpinsText}"
                   FontSize="11"
                   Foreground="{DynamicResource TextMutedBrush}"
                   HorizontalAlignment="Center"
                   AutomationProperties.AutomationId="LuckySpin_TxtTotal" />

        <!-- Zurueck Button -->
        <Button Classes="Secondary GameButton"
                Command="{Binding GoBackCommand}"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                MinHeight="48"
                AutomationProperties.AutomationId="LuckySpin_BtnBack">
          <StackPanel Orientation="Horizontal" Spacing="6">
            <mi:MaterialIcon Kind="ArrowLeft" Width="18" Height="18"
                             Foreground="{DynamicResource TextSecondaryBrush}" />
            <TextBlock Text="{loc:Translate Back}"
                       FontSize="14"
                       Foreground="{DynamicResource TextSecondaryBrush}" />
          </StackPanel>
        </Button>

      </StackPanel>
    </Grid>
  </Panel>

</UserControl>
